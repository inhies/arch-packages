# Maintainer: inhies
# Contributor: Prurigro

_pkgname=chkboot
pkgname=${_pkgname}-git
pkgver=073f110
pkgrel=1
pkgdesc="Checks all files under /boot for changes"
url="https://github.com/inhies/${_pkgname}"
license=('GPL2')
makedepends=('git')
arch=('any')

source=("git+${url}.git")
sha256sums=('SKIP')

pkgver() {
	cd "${srcdir}/${_pkgname}"
	git describe --always | sed 's|-|.|g;s|[^\.]*\.||;s|\.[^\.]*$||'
}

package() {
	install -D -m755 "${srcdir}"/${_pkgname}/chkboot "${pkgdir}"/usr/bin/chkboot
	install -D -m755 "${srcdir}"/${_pkgname}/chkboot-pacman-update "${pkgdir}"/usr/bin/chkboot-pacman-update
	install -D -m755 "${srcdir}"/${_pkgname}/chkboot-diffcheck.sh "${pkgdir}"/etc/profile.d/chkboot-diffcheck.sh
	install -D -m755 "${srcdir}"/${_pkgname}/chkboot-bootcheck.sh "${pkgdir}"/usr/bin/chkboot-bootcheck
	install -D -m644 "${srcdir}"/${_pkgname}/chkboot.conf "${pkgdir}"/etc/default/chkboot.conf
	install -D -m644 "${srcdir}"/${_pkgname}/${_pkgname}.service "${pkgdir}"/usr/lib/systemd/system/${_pkgname}.service
	install -D -m644 "${srcdir}"/${_pkgname}/${_pkgname}-boot.service "${pkgdir}"/usr/lib/systemd/system/${_pkgname}-boot.service
}
